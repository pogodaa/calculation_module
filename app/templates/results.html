{% extends "base.html" %}

{% block title %}–†–µ–∑—É–ª—å—Ç–∞—Ç—ã - –ú–æ–¥—É–ª—å —Ä–∞—Å—á—ë—Ç–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π{% endblock %}

{% block content %}
<div class="page-header">
    <h2>üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á—ë—Ç–∞</h2>
    <p class="subtitle">–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö</p>
</div>

{% if result.success %}
    <div class="alert alert-success">
        ‚úÖ –†–∞—Å—á—ë—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
    </div>
{% else %}
    <div class="alert alert-error">
        ‚ùå –†–∞—Å—á—ë—Ç –∑–∞–≤–µ—Ä—à—ë–Ω —Å –æ—à–∏–±–∫–∞–º–∏
    </div>
{% endif %}

<div class="content-grid">
    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div class="card">
        <h3>üìä –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h3>
        
        <div class="results-grid">
            {% if 'mean' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ</div>
                <div class="result-value">{{ formatted_results['mean'] }}</div>
            </div>
            {% endif %}
            
            {% if 'weighted_mean' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–°—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ</div>
                <div class="result-value">{{ formatted_results['weighted_mean'] }}</div>
            </div>
            {% endif %}
            
            {% if 'std_dev' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</div>
                <div class="result-value">{{ formatted_results['std_dev'] }}</div>
            </div>
            {% endif %}
            
            {% if 'variance' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–î–∏—Å–ø–µ—Ä—Å–∏—è</div>
                <div class="result-value">{{ formatted_results['variance'] }}</div>
            </div>
            {% endif %}
            
            {% if 'median' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–ú–µ–¥–∏–∞–Ω–∞</div>
                <div class="result-value">{{ formatted_results['median'] }}</div>
            </div>
            {% endif %}
            
            {% if 'min_value' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ</div>
                <div class="result-value">{{ formatted_results['min_value'] }}</div>
            </div>
            {% endif %}
            
            {% if 'max_value' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ</div>
                <div class="result-value">{{ formatted_results['max_value'] }}</div>
            </div>
            {% endif %}
            
            {% if 'value_range' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–†–∞–∑–º–∞—Ö</div>
                <div class="result-value">{{ formatted_results['value_range'] }}</div>
            </div>
            {% endif %}
            
            {% if 'sum' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–°—É–º–º–∞</div>
                <div class="result-value">{{ formatted_results['sum'] }}</div>
            </div>
            {% endif %}
            
            {% if 'count' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π</div>
                <div class="result-value">{{ formatted_results['count'] }}</div>
            </div>
            {% endif %}
            
            {% if 'growth_rate' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–¢–µ–º–ø —Ä–æ—Å—Ç–∞ (%)</div>
                <div class="result-value">{{ formatted_results['growth_rate'] }}%</div>
            </div>
            {% endif %}
            
            {% if 'efficiency_ratio' in formatted_results %}
            <div class="result-card">
                <div class="result-label">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
                <div class="result-value">{{ formatted_results['efficiency_ratio'] }}</div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="card">
        <h3>üìã –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        
        <h4>–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</h4>
        <table class="data-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                    <th>–í–µ—Å</th>
                    <th>–ï–¥. –∏–∑–º.</th>
                </tr>
            </thead>
            <tbody>
                {% for ind in indicators %}
                <tr>
                    <td>{{ ind.id }}</td>
                    <td>{{ "%.2f"|format(ind.value) }}</td>
                    <td>{{ "%.2f"|format(ind.weight) }}</td>
                    <td>{{ ind.unit or '-' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if coefficients %}
        <h4 style="margin-top: 20px;">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã:</h4>
        <ul>
            {% if 'previous_period_value' in coefficients %}
            <li><strong>–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</strong> {{ coefficients['previous_period_value'] }}</li>
            {% endif %}
            {% if 'output_value' in coefficients %}
            <li><strong>–í—ã—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</strong> {{ coefficients['output_value'] }}</li>
            {% endif %}
            {% if 'input_value' in coefficients %}
            <li><strong>–í—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</strong> {{ coefficients['input_value'] }}</li>
            {% endif %}
        </ul>
        {% endif %}
    </div>
</div>

<!-- –û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è -->
{% if result.errors %}
<div class="card">
    <h3 style="color: #d32f2f;">‚ö†Ô∏è –û—à–∏–±–∫–∏</h3>
    <ul>
        {% for error in result.errors %}
        <li>{{ error }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

{% if result.warnings %}
<div class="card">
    <h3 style="color: #ed6c02;">‚ÑπÔ∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</h3>
    <ul>
        {% for warning in result.warnings %}
        <li>{{ warning }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
<div class="button-group" style="margin-top: 20px; justify-content: center;">
    <a href="/" class="btn btn-primary" style="text-decoration: none; display: inline-block;">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–∞—Å—á—ë—Ç–∞–º</a>
    <button class="btn btn-secondary" onclick="window.print()">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
</div>
{% endblock %}